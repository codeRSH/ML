install.packages(c("caret", "kableExtra", "modeldata"))
require(modeldata)
require(dplyr)
require(ggplot2)
theme_set(theme_bw()) # set theme
require(CHAID)
require(purrr)
require(caret)
#Load the data
data(attrition)
#. The str command shows we have a bunch of variables which are of type integer.
str(attrition)
#Load the data
data(attrition)
#. The str command shows we have a bunch of variables which are of type integer.
str(attrition)
#Checking number of variables as factor
attrition %>%
select_if(is.factor) %>%
ncol
#Checking number of variables as numeric
attrition %>%
select_if(is.numeric) %>%
ncol
#variables that are integers how many of them have a small number of values
attrition %>%
select_if(function(col)
length(unique(col)) <= 5 & is.integer(col)) %>%
head
attrition %>%
select_if(function(col)
length(unique(col)) <= 10 & is.integer(col)) %>%
head
#Normal Way
attrition %>%
mutate(
JobLevel = factor(JobLevel),
NumCompaniesWorked = factor(NumCompaniesWorked),
StockOptionLevel = factor(StockOptionLevel),
TrainingTimesLastYear = factor(TrainingTimesLastYear)
) %>%
str
####Another way
attrition <- attrition %>%
mutate_if(function(col) length(unique(col)) <= 10 & is.integer(col), as.factor)
#Checking number of variables as factor
attrition %>%
select_if(is.factor) %>%
ncol
str(attrition)
summary(attrition)
newattrit <- attrition %>%
select_if(is.factor)
dim(newattrit)
# demonstrate a full model using chaid with defaults
chaidattrit1 <- chaid(Attrition ~ ., data = newattrit)
#Printing CHAID results
print(chaidattrit1)
require(CHAID)
require(chaid)
require(CHAID)
